<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Cerdas Usman Forsaken</title>
    <style>
        /* --- CSS --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .chat-container {
            width: 100%;
            max-width: 450px;
            height: 80vh;
            max-height: 700px;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bot-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            background-color: #4CAF50;
            border-radius: 50%;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }

        .chat-window {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: #f9f9f9;
        }

        .message {
            padding: 12px 16px;
            border-radius: 20px;
            max-width: 80%;
            word-wrap: break-word;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .bot-message {
            background-color: #e9ecef;
            color: #333;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .user-message {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .message-time {
            font-size: 0.7em;
            color: #888;
            margin-top: 5px;
            text-align: right;
        }

        .bot-message .message-time {
            text-align: left;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background-color: #e9ecef;
            border-radius: 20px;
            border-bottom-left-radius: 5px;
            max-width: 80px;
        }

        .typing-dot {
            height: 8px;
            width: 8px;
            background-color: #888;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .search-result {
            background-color: #f0f7ff;
            border-left: 4px solid #007bff;
            padding: 10px;
            margin-top: 5px;
            border-radius: 0 5px 5px 0;
        }

        .search-result-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .search-result-snippet {
            font-size: 0.9em;
            color: #555;
        }

        .search-result a {
            color: #007bff;
            text-decoration: none;
            font-size: 0.9em;
        }

        .chat-input-area {
            display: flex;
            padding: 15px;
            border-top: 1px solid #ddd;
            background-color: #fff;
        }

        #user-input {
            flex-grow: 1;
            border: 1px solid #ccc;
            border-radius: 25px;
            padding: 12px 20px;
            font-size: 1em;
            outline: none;
            transition: border-color 0.3s;
        }

        #user-input:focus { border-color: #007bff; }

        #send-button {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-left: 10px;
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        #send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px;
            background-color: #f0f0f0;
            border-top: 1px solid #ddd;
        }

        .quick-action-btn {
            padding: 6px 12px;
            background-color: #e9ecef;
            border: none;
            border-radius: 15px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .quick-action-btn:hover { background-color: #d0d0d0; }
    </style>
</head>
<body>
    <div class="chat-container">
        <header class="chat-header">
            Chatbot Usman Forsaken
            <span class="bot-status"></span>
        </header>
        <main class="chat-window" id="chat-window">
            <!-- Pesan akan muncul di sini -->
        </main>
        <div class="quick-actions">
            <button class="quick-action-btn" data-question="Apa kabar?">Apa kabar?</button>
            <button class="quick-action-btn" data-question="dimana infokom?">dimana infokom?</button>
            <button class="quick-action-btn" data-question="Siapa usman?">Siapa usman?</button>
            <button class="quick-action-btn" data-question="Berita terbaru">Berita terbaru</button>
             <button class="quick-action-btn" data-question="nama kepala sekolah di infokom">nama kepala sekolah di infokom</button>
            <button class="quick-action-btn" data-question="fasilitas yang ada di infokom">fasilitas yang ada di infokom</button>
            <button class="quick-action-btn" data-question="apa hal yang menarik di smk infokom">apa hal yang menarik di smk infokom</button>
            <button class="quick-action-btn" data-question="Bantuan">Bantuan</button>
             <button class="quick-action-btn" data-question="ada jurusan apa saja di infokom?">ada jurusan apa saja di infokom?</button>
        </div>
        <footer class="chat-input-area">
            <input type="text" id="user-input" placeholder="Ketik pesan..." autocomplete="off">
            <button id="send-button">âž¤</button>
        </footer>
    </div>

    <script>
        // --- JavaScript ---

        const chatWindow = document.getElementById('chat-window');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const quickActionBtns = document.querySelectorAll('.quick-action-btn');

        function appendMessage(message, sender, isSearchResult = false) {
            const messageContainer = document.createElement('div');
            messageContainer.classList.add('message');
            
            if (sender === 'bot') {
                messageContainer.classList.add('bot-message');
            } else {
                messageContainer.classList.add('user-message');
            }

            if (isSearchResult && typeof message === 'object') {
                const titleElement = document.createElement('div');
                titleElement.classList.add('search-result-title');
                titleElement.textContent = message.title;
                
                const snippetElement = document.createElement('div');
                snippetElement.classList.add('search-result-snippet');
                snippetElement.textContent = message.snippet;
                
                const linkElement = document.createElement('a');
                linkElement.href = message.link;
                linkElement.textContent = "Baca selengkapnya...";
                linkElement.target = "_blank";
                
                messageContainer.appendChild(titleElement);
                messageContainer.appendChild(snippetElement);
                messageContainer.appendChild(linkElement);
            } else {
                messageContainer.textContent = message;
            }
            
            const timeElement = document.createElement('div');
            timeElement.classList.add('message-time');
            timeElement.textContent = new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
            messageContainer.appendChild(timeElement);
            
            chatWindow.appendChild(messageContainer);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function showTypingIndicator() {
            const typingContainer = document.createElement('div');
            typingContainer.classList.add('typing-indicator');
            typingContainer.id = 'typing-indicator';
            
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('span');
                dot.classList.add('typing-dot');
                typingContainer.appendChild(dot);
            }
            
            chatWindow.appendChild(typingContainer);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Fungsi untuk mencari informasi di web menggunakan DuckDuckGo API
        async function searchWeb(query) {
            try {
                const response = await fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json&pretty=1`);
                const data = await response.json();
                
                if (data.AbstractText) {
                    return {
                        title: data.Heading,
                        snippet: data.AbstractText,
                        link: data.AbstractURL
                    };
                }

                if (data.RelatedTopics && data.RelatedTopics.length > 0) {
                    const validResults = data.RelatedTopics.filter(topic => 
                        topic.Text && topic.FirstURL && !topic.FirstURL.includes('duckduckgo')
                    );
                    
                    if (validResults.length > 0) {
                        const text = validResults[0].Text;
                        const url = validResults[0].FirstURL;
                        return {
                            title: text.split(' - ')[0],
                            snippet: text.split(' - ')[1] || text,
                            link: url
                        };
                    }
                }
                
                return null;
            } catch (error) {
                console.error('Error searching web:', error);
                return null;
            }
        }

        // Fungsi untuk menghasilkan respons dari bot
        async function generateBotResponse(userMessage) {
            const lowerCaseMessage = userMessage.toLowerCase();

            // 1. Pertanyaan langsung & fungsi sederhana
            if (lowerCaseMessage.includes('halo') || lowerCaseMessage.includes('hai')) {
                return 'Halo! Ada yang bisa saya bantu hari ini?';
            } else if (lowerCaseMessage.includes('terima kasih') || lowerCaseMessage.includes('makasih')) {
                return 'Sama-sama! Senang bisa membantu.';
            } else if (lowerCaseMessage.includes('apa kabar')) {
                return 'Saya baik baik saja, ada yang bisa saya bantu?.';
            } else if (lowerCaseMessage.includes('dimana infokom')) {
                return 'Jalan Letjen Ibrahim Adjie No. 178, Sindangbarang, Kecamatan Bogor Barat, Kota Bogor, Jawa Barat';
            } else if (lowerCaseMessage.includes('ada jurusan apa saja di infokom')) {  
                return 'SMK Infokom Bogor memiliki empat jurusan utama: Rekayasa Perangkat Lunak (RPL), Teknik Komputer dan Jaringan (TKJ), Desain Komunikasi Visual (DKV), dan Produksi Siaran Program Televisi (PSPT)';  
            } else if (lowerCaseMessage.includes('kenapa usman jago main forsaken?')) {        
                return 'karena dia adalah orang yang gigih dan pantang menyerah, ini adalah sifat yang harus kamu teladani UwU';
            } else if (lowerCaseMessage.includes('apa hal yang menarik di smk infokom')) {      
                return 'Hal menarik di SMK Infokom Bogor antara lain adalah memiliki empat pilihan jurusan yang berfokus pada bidang teknologi informasi dan kreatif, yaitu Rekayasa Perangkat Lunak (RPL), Teknik Komputer Jaringan (TKJ), Desain Komunikasi Visual (DKV), dan Produksi Siaran Program Televisi (PSPT). Selain itu, sekolah ini memiliki visi untuk menjadi sekolah yang kompeten di tingkat nasional maupun internasional dan berbudaya lingkungan hidup, serta bertekad membangun mental dan sikap siswa yang beriman';
            } else if (lowerCaseMessage.includes('jam berapa')) {
                return `Sekarang jam ${new Date().toLocaleTimeString('id-ID')}.`;
            } else if (lowerCaseMessage.includes('siapa usman')) {       
                return 'murid smk infokom kelas 10 rpl 2 dengan hobi bermain game,badminton dan berenang :3';
            } else if (lowerCaseMessage.includes('nama kepala sekolah di infokom')) {     
                return 'Nama kepala sekolah di SMKS Infokom Bogor adalah Liliek Rahmaningsih';  
            } else if (lowerCaseMessage.includes('fasilitas yang ada di infokom')) {      
                return 'SMK Infokom Bogor memiliki berbagai fasilitas akademik seperti ruang kelas, laboratorium (RPL, TKJ, DKV, PSPT), ruang praktik, studio cast, dan perpustakaan';  
            } else if (lowerCaseMessage.includes('tanggal berapa')) {
                return `Hari ini adalah ${new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}.`;
            } else if (lowerCaseMessage.includes('bantuan') || lowerCaseMessage.includes('help')) {
                return 'Saya bisa membantu Anda dengan:\n- Menjawab pertanyaan umum\n- Mencari berita atau informasi terkini\n- Menjelaskan berbagai topik\n- Melakukan perhitungan sederhana (ketik "hitung [angka]")\n\nCoba ajukan pertanyaan apa saja!';
            } else if (lowerCaseMessage.includes('hitung') || lowerCaseMessage.includes('calculate')) {
                try {
                    const expression = userMessage.replace(/[^0-9+\-*/().\s]/g, '');
                    if (expression) {
                        const result = Function('"use strict"; return (' + expression + ')')();
                        return `Hasil perhitungan: ${result}`;
                    }
                } catch (e) {
                    return 'Maaf, saya tidak bisa menghitung ekspresi tersebut. Pastikan formatnya benar.';
                }
            }
            
            // 2. Pertanyaan yang mungkin memerlukan pencarian web
            showTypingIndicator();
            let searchResult = await searchWeb(userMessage);
            removeTypingIndicator();

            if (searchResult) {
                appendMessage('Berdasarkan pencarian saya, ini yang saya temukan:', 'bot');
                appendMessage(searchResult, 'bot', true);
                return 'Apakah ini menjawab pertanyaan Anda?';
            }
            
            // 3. Respons default jika tidak ada yang cocok
            const defaultResponses = [
                'Maaf, saya tidak menemukan informasi spesifik tentang itu. Coba ajukan dengan kata kunci yang berbeda.',
                'Itu pertanyaan yang menarik. Sayangnya, saya tidak memiliki jawaban untuk itu saat ini.',
                'Saya masih belajar tentang itu. Mungkin coba cari di mesin pencari?'
            ];
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        function handleSendMessage() {
            const userMessage = userInput.value.trim();
            if (userMessage === '') return;

            appendMessage(userMessage, 'user');
            userInput.value = '';

            setTimeout(async () => {
                const botResponse = await generateBotResponse(userMessage);
                appendMessage(botResponse, 'bot');
            }, 500); // Jeda 0.5 detik untuk simulasi berpikir
        }

        sendButton.addEventListener('click', handleSendMessage);
        userInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                handleSendMessage();
            }
        });

        // Event listener untuk tombol aksi cepat
        quickActionBtns.forEach(button => {
            button.addEventListener('click', () => {
                userInput.value = button.getAttribute('data-question');
                handleSendMessage();
            });
        });

        // Pesan pembuka
        window.addEventListener('load', () => {
            appendMessage('Halo! Saya adalah versi upgrade dari chatbot Usman Forsaken. Sekarang saya bisa mencari info di web. Ada yang bisa saya bantu?', 'bot');
        });
    </script>
</body>
</html>
